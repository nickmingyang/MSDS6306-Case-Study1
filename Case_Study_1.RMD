---
title: "Case_Study_1"
author: "Team Project - Babatunde John Olanipekun, Yvan Sojdehei and Mingyang Nick YU"
date: "9/30/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Beer and Breweries Exploration
Introduction: This is an exploratory data analysis for the data set between Beers.csv and Breweries.csv for CEO and CFO of Budweiser

### Loading the datasets
Doing intial inspection of data through various methods below.
```{r}
# dataset should be in the same folder of this RMD file
Beers = read.csv("/Users/mingyang/Desktop/SMU/DoingDS_Fall2020/MSDS6306-Case-Study1/Beers.csv",header = TRUE) #loading beers dataset
Breweries = read.csv("/Users/mingyang/Desktop/SMU/DoingDS_Fall2020/MSDS6306-Case-Study1/Breweries.csv",header = TRUE) #loading breweries dataset
#below this line is for self analyzation
#summary(Beers)
#str(Beers)
##Beers$IBU
#summary(Breweries)
#str(Breweries)
#Above this line is for self analyzing can be deleted later
#Turn Breweries State column into a factor
Breweries$State = as.factor(Breweries$State)
```

### How many breweries are present in each state?
- As we can see by the plot below, each state's breweries count is displayed in a bar chart 
- To make it easier to see which state has the most breweries, we assorted the breweries count by descending order
```{r}
library(tidyverse) 
library(ggplot2)
num_Breweries_by_state = Breweries %>% group_by(State) %>%
  summarise(count=n())
num_Breweries_by_state
#As we can see the number of breweries per state is in the list below, to see this better we will use a plot to show results
ggplot(data=num_Breweries_by_state)+
  geom_bar(mapping=aes(x=State,y=count,fill=State),stat="identity") +
  ggtitle("Breweries count by state")+xlab("State")+ylab("Count of Breweries")
#To see this by descend of count
ggplot(data=num_Breweries_by_state)+
  geom_bar(mapping=aes(x=reorder(State,-count),y=count,fill=State),stat="identity") +
  ggtitle("Breweries count by state")+xlab("State")+ylab("Count of Breweries")
```

Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  
```{r}
Beers = Beers %>% rename(Brew_ID= Brewery_id)
Beers.with.Breweries = left_join(Beers,Breweries, by = "Brew_ID")
```


### Address the missing values in each column
- There are 62 missing values on ABV column, and there are 1005 missing values on IBU column
- Since 1005/2410 is too big of a percentage of missing value for column IBU, I decided to use Predictive mean matching method(widely used statistical imputation method for missing values, first proposed by Donald B. Rubin in 1986 and R. J. A. Little in 1988) to fill the missing data.
- After generating and filling in the missing data, through density plot below, we can see the generated filled in value matches the original density plot. Thus minimize any bias from the researcher of arbitrarily filling in value or overeasily using the overall mean for all missing value
```{r}
Beers.with.Breweries = Beers.with.Breweries %>% rename(Beer_Name= Name.x)
Beers.with.Breweries = Beers.with.Breweries %>% rename(Brew_Name= Name.y)
summary(Beers.with.Breweries)
library(mice) #Load mice library to analyze the pattern of missing data
md.pattern(Beers.with.Breweries)
# Since there is large amont of data missing in IBM column 
#Try to impute the missing data with Predictive mean Matching method
tempData <- mice(Beers.with.Breweries,m=5,maxit=50,meth='pmm',seed=20)
#summary(tempData)
completedData <- complete(tempData,1)
#head(completedData)
# Density plot original vs imputed dataset
densityplot(tempData)
#Note: idea used above to impute data is from link below:
#https://datascienceplus.com/imputing-missing-data-with-r-mice-package/
```
### Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare
- First plotted Median alcohol content by state, one with modified data set, and the other one with non-modified data set
- Then plotted Median international bitterness unit for each state, both on the modified data set and non-modified
- We can see between the modified data and non-modified data provides very different answers. If possible, going back to try to complete the missing data will make the graphics more accurate. But this is a random estimate of the actual value
```{r}
#Compute and display Median of ABV and IBU by state:
median = completedData %>% group_by(State) %>%
  summarize(median_ABV=median(ABV),median_IBU=median(IBU))
median
#Draw Bar Charts to compare
#First plot median of alcohol content using modified data
median %>% ggplot()+
  geom_bar(mapping=aes(x=reorder(State,-median_ABV),y=median_ABV,fill=State),stat="identity") +
  ggtitle("Median Alcohol content by State on modified dataset")+xlab("State")+ylab("Alcohol Content Percentage")
#Below is result of using complete data set with missing data to plot median of alcohol content
Beers.with.Breweries %>% group_by(State) %>%
  summarize(median_ABV=median(ABV),median_IBU=median(IBU))%>% ggplot()+
  geom_bar(mapping=aes(x=reorder(State,-median_ABV),y=median_ABV,fill=State),stat="identity")+
  ggtitle("Median Alcohol content by State on non-Modified dataset")+xlab("State")+ylab("Alcohol Content Percentage")
#Below is result of plotting median international bitterness unit for each state on modified data set
median %>% ggplot()+
  geom_bar(mapping=aes(x=reorder(State,-median_IBU),y=median_IBU,fill=State),stat="identity") +
  ggtitle("Median International Bitterness Unit by State on modified dataset")+xlab("State")+ylab("International Bitterness Unit")
#Below is result of using complete data set with missing data to plot median of alcohol content
Beers.with.Breweries %>% group_by(State) %>%
  summarize(median_ABV=median(ABV),median_IBU=median(IBU))%>% ggplot()+
  geom_bar(mapping=aes(x=reorder(State,-median_IBU),y=median_IBU,fill=State),stat="identity") +
  ggtitle("Median International Bitterness Unit by State on non-modified dataset")+xlab("State")+ylab("International Bitterness Unit")

```
### Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
As we can see below, Colorado 'CO' has the maximum alcoholic(ABV) beer, it is (0.128)
- This above result remain unchanged with the original data set
As we can see, Oregon and Michigan have the most bitter beer
- Only Oregon has the most bitter beer in the unchanged data set. It means the Michigan bee bitterness value was imputed
```{r}
# Discover which state has the maximum alcoholic beer
head(completedData %>%
  arrange(desc(ABV)) %>% 
  select(State,ABV,Beer_Name))
# Discover with un-changed data set
head(Beers.with.Breweries %>%
  arrange(desc(ABV)) %>% 
  select(State,ABV,Beer_Name))

# Discover which state has the most bitter (IBU) beer
head(completedData %>%
  arrange(desc(IBU)) %>% 
  select(State,IBU,Beer_Name))

# Discover with un-changed data set
head(Beers.with.Breweries %>%
  arrange(desc(IBU)) %>% 
  select(State,IBU,Beer_Name))
  
```

### Comment on the summary statistics and distribution of the ABV variable.
For the adjusted data set, we have
- Minimum ABV value: 0.001 (minimum value of the group, CEO and CFO might be interested)
- First quartile ABV: 0.05
- Median of ABV: 0.056 (center among the entire group, CEO and CFO might be interested)
- Mean of ABV: 0.05975 (Average of the entire group, CEO and CFO might be interested)
- Third Quartile ABV: 0.067
- Maximum ABV: 0.128 (maximum value of the group, CEO and CFO might be interested)
Comparing the adjusted Data and Unadjusted data, Statistics doesn't change much at all since it is imputed by Predictive mean matching method
```{r}
# Summary of adjusted Data
summary(completedData)
# Summary of unadjusted Data
summary(Beers.with.Breweries)
```
### Is there an apparent relationship between the bitterness of the beer and its alcoholic content?
We can see from the scatter plot, there seem to be some sort of relationship between the two
- As ABV value increases, IBU seem to also increase
This relationship seem to persist when we compare to the unmodified data
```{r}
#first explore modified data
completedData %>% select(ABV, IBU, State) %>%
  ggplot(aes(x=ABV,y=IBU)) +
  geom_point(position="jitter") +ggtitle("IBU vs. ABV -- modified data")
#next explore unmodified data
Beers.with.Breweries %>% select(ABV, IBU, State) %>%
  ggplot(aes(x=ABV,y=IBU)) +
  geom_point(position="jitter") +ggtitle("IBU vs. ABV -- unmodified data")
  
```































