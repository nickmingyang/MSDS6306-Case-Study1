ABV Heatmap

```{r}
library(ggplot2)
library(maps)
library(dplyr)
library(mapproj)
library(plyr)

#Acu = read.csv(file.choose(),header = TRUE) # read in company data
lookup = data.frame(abb = state.abb, State = state.name) #makes a data frame with State name and abbreviation. 
lookup
Breweries2 = merge(Beers.with.Breweries,lookup, "abb", all = TRUE) # make one dataset with state names and abb
Breweries2
Breweries2$ABV <- as.numeric(Breweries2$ABV)
BreweriesMapData <- Breweries2 %>% select(ABV, State) %>% group_by(State)
BreweriesMapData
BreweriesMapData <- aggregate(. ~ State, BreweriesMapData, mean)
#AcuMapData = AcuMapData[-c(5,9,43),] #Shows contrast between other states better
#colnames(BreweriesMapData)[2] = "Breweries" #change "n" to "Acuspikes"
BreweriesMapData$region <- tolower(BreweriesMapData$State)
BreweriesMapData = BreweriesMapData[-1]
BreweriesMapData
states <- map_data("state")
states
map.df <- full_join(states,BreweriesMapData, by="region", all.x=T)
map.df
map.df <- map.df[order(map.df$order),]
h <- ggplot(map.df, aes(x=long,y=lat,group=group))+
  geom_polygon(aes(fill=ABV))+
  geom_path()+ 
  scale_fill_gradientn(colours=rev(heat.colors(5)),na.value="grey90")+ggtitle("Average ABV By State")+
coord_map()
ggplotly(h)
```

ABV Density Map

```{r}
library(ggplot2)
library(maps)
library(dplyr)
library(mapproj)
library(plyr)
library(ggmap)
library(sf)
library(usmap)
library(rgdal)
library(maptools)
#Acu = read.csv(file.choose(),header = TRUE) # read in company data
lookup = data.frame(abb = state.abb, State = state.name) #makes a data frame with State name and abbreviation. 
lookup
Breweries2 = merge(Beers.with.Breweries,lookup, "abb", all = TRUE) # make one dataset with state names and abb
Breweries2
Breweries2$ABV <- as.numeric(Breweries2$ABV)
BreweriesMapData <- Breweries2 %>% select(ABV, State) %>% group_by(State)
BreweriesMapData
BreweriesMapData <- aggregate(. ~ State, BreweriesMapData, mean)
#AcuMapData = AcuMapData[-c(5,9,43),] #Shows contrast between other states better
#colnames(BreweriesMapData)[2] = "Breweries" #change "n" to "Acuspikes"
BreweriesMapData$region <- tolower(BreweriesMapData$State)
BreweriesMapData = BreweriesMapData[-1]
BreweriesMapData
states <- read.csv("/Users/ysojd/Desktop/GRAD SCHOOL COURSEWORK/MSDS_6306_Doing-Data-Science-Master/MSDS_6306_Doing-Data-Science-Master/Case Study 1/uscities.csv")
states$region <- tolower(states$state)
states
map.df <- merge(states, BreweriesMapData, by="region")
map.df
colnames(map.df)
map.df <- map.df[, c(9,8,1,2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19)]
map.df <- usmap_transform(map.df)
map.df
#map.df <- map.df[order(map.df$order),]
plot_usmap() +
  geom_point(data = map.df, aes(x = lng.1, y = lat.1, size = ABV),
             color = "Dark Green", alpha = .01) +
  labs(title = "Average ABV By City per State",
       subtitle = "Source: USGS",
       size = "ABV") +
  theme(legend.position = "right")
```